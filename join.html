<!doctype html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <link rel="icon" type="image/png" href="favicon.png" />
    <title>GenThresh</title>
    <meta name="description" content="Generate Threshold Signatures">
    <meta name="Kee Jefferys" content="SitePoint">

</head>

<body>

    <div class="titlebox">
        <div class="title">
            Group Sign
        </div>
        <div class="emojititle">
            <a class="emojilink" href="Genthresh.html">ğŸ§™</a>
        </div>
    </div>

    <div class="buttonbox" id="groupinfobox">

        <div class="keys" id="ThresholdDisplay"></div>
        <div id="buttonSavegroup">
            <button onclick="groupInfo()" class="emojibutton">&nbsp;ğŸ’¾ Save Group Info</button>
        </div>

    </div>

    <div class="namecontainer" id="nameContainer">

        <input class="namebox" id="nameEntry" type="text" placeholder="Enter name here" /> <button class="copyButton"
            id="enterName" onclick="getName()">âœ”ï¸</button>

    </div>

    <div class="roomcontainer" id="roomcontainer">
        <input class="roombox" id="roombox" type="text" readonly /> <button class="copyButton"
            onclick="copyClipboard()">ğŸ“‹</button>
    </div>

    <div class="keycontainer">

        <div class="keys" id="pubKeyText">
        </div>
        <div class="keysdisplay" id="pubKeyDisplay">

        </div>
    </div>

    <div class="GenerateFramework" id="GenerateFramework">

        <div class="buttonbox" id="generateOrLoad">

            <div id="button1">
                <button onclick="generateNewKeypair()" class="emojibutton">&nbsp;ğŸ”‘ Generate Keypair</button>
            </div>
            <div id="button1">
                <button onclick="getKeys()" class="emojibutton">&nbsp;â¬†ï¸ğŸ’¾Import Keypair</button>
            </div>

        </div>


        <div class="keycontainer" id="GeneratedKeyBox">

            <div class="keys" id="pubKeyText">
                Your keys <button class="copyButton" onclick="copyClipboard()">ğŸ“‹</button>
            </div>
            <div class="keysdisplay" id="pubKeyDisplayPublic"></div>
        </div>

        <div class="buttonbox" id="buttonboxthreshold">

            <div id="button1">
                <button onclick="nameChoose()" class="emojibutton">&nbsp;â¡ï¸ Next</button>
            </div>

        </div>

    </div>

    <div class="keys" id="wait"></div>
    <div id="readybutton"><button class="copyButton" id="enterName" onclick="readyUp(chosenRoom)">Are you
            Ready?âœ”ï¸</button>
    </div>

    <div class="keycontainer" id="ProposedMessageDisplay">

        <div class="keys" id="pubKeyText">
            Proposed Message
        </div>
        <div class="keysdisplay" id="proposedMessageBox"></div>
    </div>

    <div class="buttonbox" id="signOrNot">

        <div id="button1">
            <button onclick="sendMessage()" class="emojibutton">&nbsp;âœ”ï¸ Sign</button>
        </div>

        <div id="button1">
            <button onclick="reject()" class="emojibutton">&nbsp;âŒ Reject</button>
        </div>
    </div>

    <div id="myProgress">
        <div id="currentSigned"></div>
        <div id="thresholdBar"></div>
    </div>

    <div class="Legend" id="Legend">

        <div class="colour darkpurp"></div>Already Signed
        <div class="colour lightpurp"></div>Threshold
        <div class="colour yellow"></div>Maximum

    </div>

    <div id="roomIsFull" class="keys">Room is full please contact the operator</div>

    <div class="keysdisplay" id="aggSigAggKeyDisplay"></div>

    <div class="buttonbox" id="buttonboxpadding">

        <div id="button1">
            <button onclick="downloadsigs()" class="emojibutton" id ="SaveSignatureInfo">&nbsp;ğŸ’¾ Save Signature info</button>
        </div>

    </div>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.3.0/socket.io.js"></script>
    <script src="bundle.js"></script>

    <script>

        chosenRoom = window.location.href
        chosenRoom = chosenRoom.split('?')[1]

        privKey = ''
        pubKey = ''
        firstJoin = true
        signerCount = 0
        threshold = ''
        frozenUserList = []
        signers = ''
        steps = ''
        thresholdSet = ''
        signatureArray = []

        var socket = io.connect("http://localhost:8000");
        checkroomfull()

        function startSocket() {
            socket.emit('create', chosenRoom);
        }

        function setUsername(name, roomid) {
            socket.emit('setUsername', { namewanted: name, roomname: roomid, socketid: socket.id, isLeader: false, publicKey: pubKey });
        };

        function checkroomfull() {
            socket.emit('checkRoom', { roomid: chosenRoom })
        }

        function nameChoose() {
            document.getElementById("GenerateFramework").style.display = 'none'
            document.getElementById("nameContainer").style.display = 'block'
        }

        function aggregateKeys(keyArray) {
            singleKey = myBundle.aggKey(keyArray)
            return singleKey
        }


        function aggregateSignature(signatureArray) {
            agg = myBundle.aggSig(signatureArray)
            return agg
        }

        function getUsers() {
            socket.emit('getUsers', { roomid: chosenRoom });
            document.getElementById("readybutton").style.display = 'block'
            document.getElementById("GenerateFramework").style.display = 'none'
        };

        socket.on('roomFullEvent', function (data) {
            if (data == true) {
                roomIsFull()
            }
        });

        socket.on('getUsers', function (data) {
            userList = data.userlist
            readyUsers = 0

            document.getElementById("pubKeyDisplay").style.display = "block"
            document.getElementById("pubKeyDisplay").innerHTML = ""


            for (let index = 0; index < userList.length; index++) {

                name = userList[index].name;
                socketchoice = userList[index].socketid
                document.getElementById("pubKeyDisplay").innerHTML += "<div id=" + socketchoice + "" + " class=\"joinedNames\">" + name + "</div>"
                if (userList[index].readyStatus == true) {
                    document.getElementById(socketchoice).innerText += "âœ”ï¸"
                    readyUsers++
                }
                if (userList[index].isLeader == true) {
                    signers = userList[index].signers
                    threshold = userList[index].threshold

                    steps = 100 / signers
                    thresholdSet = threshold * steps

                    document.getElementById("ThresholdDisplay").innerHTML = "Signers: " + signers + " Threshold: " + threshold

                }

                if (readyUsers == signers && frozenUserList.length == 0) {
                    //Freeze getinfo Array when everyone is joined
                    frozenUserList = userList
                }

            }

            if (readyUsers == signers) {

                document.getElementById("groupinfobox").style.display = "block"
            }
        })


        function readyUp(roomid) {
            document.getElementById("readybutton").style.display = "none"
            socket.emit('readyUp', { roomname: roomid, socketid: socket.id });
        };

        function roomIsFull() {
            document.getElementById("roomIsFull").style.display = "block"
            document.getElementById("generateOrLoad").style.display = "none"

        }

        function reject() {
            document.getElementById("signOrNot").style.display = "none"
        }

        async function sendMessage() {
            var message = document.getElementById('proposedMessageBox').innerText;
            signature = await myBundle.signMessage(privKey, message)
            signature = bufferToHex(signature)

            for (let index = 0; index < frozenUserList.length; index++) {
                element = frozenUserList[index];

                if (element.publicKey == pubKey) {
                    arrayPosition = index
                    break
                }

            }

            if (message) {
                document.getElementById("signOrNot").style.display = "none"
                socket.emit('msg', { message: message, signature: signature, roomid: chosenRoom, publicKey: pubKey, leaderstatus: false, arrayPosition: arrayPosition });
            }
        }
        socket.on('newmsg', async function (data) {

            if (data.leaderstatus == true) {
                document.getElementById("proposedMessageBox").innerText = data.msg
                document.getElementById("ProposedMessageDisplay").style.display = "block"
                document.getElementById("myProgress").style.display = "block"
                document.getElementById("Legend").style.display = "flex"
                document.getElementById("signOrNot").style.display = "block"
            }

            signatureArray.push({ message: data.msg, signature: data.signature, publicKey: data.publicKey, arrayPosition: data.arrayPosition })

            signerCount++
            document.getElementById("currentSigned").style.width = signerCount * steps + "%"
            document.getElementById("thresholdBar").style.width = thresholdSet + "%"

            if (signerCount >= threshold) {

                document.getElementById("SaveSignatureInfo").style.display = 'flex'

                if (signerCount == signers) {
                document.getElementById("ProposedMessageDisplay").style.display = 'none'
                document.getElementById("myProgress").style.display = 'none'
                document.getElementById("Legend").style.display = 'none'
                }

                aggregateKeyArray = []
                aggregateSignatureArray = []
                signerIndex = []
                for (let index = 0; index < signatureArray.length; index++) {
                    signerIndex.push(signatureArray[index].arrayPosition)
                    aggregateKeyArray.push(signatureArray[index].publicKey);
                    aggregateSignatureArray.push(signatureArray[index].signature);
                }

                finalAggKeys = await aggregateKeys(aggregateKeyArray)
                finalAggKeys = bufferToHex(finalAggKeys)
                finalAggSig = await aggregateSignature(aggregateSignatureArray)
                finalAggSig = bufferToHex(finalAggSig)

                document.getElementById("aggSigAggKeyDisplay").style.display = "block"
                document.getElementById("aggSigAggKeyDisplay").innerHTML = '<div>Aggregate Key:</div>' + finalAggKeys + '\n';
                document.getElementById("aggSigAggKeyDisplay").innerHTML += '<div class ="publickey">Aggregate Signature:</div>' + finalAggSig
                document.getElementById("aggSigAggKeyDisplay").innerHTML += '<div class ="publickey">Signer Indexes:</div>' + signerIndex

            }
        })

        function getName() {
            yourName = randomEmoji() + " " + document.getElementById("nameEntry").value;
            startSocket()
            setUsername(yourName, chosenRoom)
            document.getElementById("nameContainer").remove()
            getUsers()

        }

        function GenerateOrLoad() {
            document.getElementById("generateOrLoad").style.display = "block"
        }

        function generateNewKeypair() {
            var array = new Uint8Array(64);
            privKey = bufferToHex(window.crypto.getRandomValues(array)) // This needs to be review for security
            pubKey = bufferToHex(myBundle.generatePubKey(privKey)); // calling code from the bundle
            document.getElementById("GeneratedKeyBox").style.display = "block"
            document.getElementById("pubKeyDisplayPublic").innerHTML = '<div>Public Key:</div>' + pubKey + '\n';
            document.getElementById("pubKeyDisplayPublic").innerHTML += '<div class ="publickey">Private Key:</div>' + privKey
            document.getElementById("buttonboxthreshold").style.display = "block"

        }

        async function groupInfo() {
            keyArray = []
            proposedDownloadText = "Number of Signers: " + signers + "\n"
            proposedDownloadText += "Threshold Required: " + threshold + "\n"

            for (let index = 0; index < frozenUserList.length; index++) {
                const element = frozenUserList[index];
                keyArray.push(element.publicKey)
                proposedDownloadText += "Key " + index + " :" + element.publicKey + "\n"

            }
            aggkey = await aggregateKeys(keyArray) // deal with the promise, might be because i fucked with the function
            aggkey = bufferToHex(aggkey)
            proposedDownloadText += "Aggregate Key: " + aggkey + "\n"

            let today = new Date().toISOString().slice(0, 10)
            filename = 'GroupInfoBLS' + today + '.txt'
            downloadtext(proposedDownloadText,filename)


        }

        function downloadsigs(){
            proposedText = document.getElementById("aggSigAggKeyDisplay").innerText
            let today = new Date().toISOString().slice(0, 10)
            proposedFileName = 'SignatureInfoBLS' + today + '.txt'
            downloadtext(proposedText,proposedFileName)
        }


        function downloadtext(proposedMessage, proposedFilename){

            var hiddenElement = document.createElement('a');
            hiddenElement.href = 'data:attachment/text,' + encodeURI(proposedMessage);
            hiddenElement.target = '_blank';
            let today = new Date().toISOString().slice(0, 10)
            hiddenElement.download = proposedFilename;
            hiddenElement.click();

        }


        function bufferToHex(buffer) {
            return [...new Uint8Array(buffer)]
                .map(b => b.toString(16).padStart(2, "0"))
                .join("");
        }

        function getKeys() {
            var input = document.createElement('input');
            input.type = 'file';

            input.onchange = e => {
                var filetest = e.target.files[0];
                console.log(filetest.name)

                // setting up the reader
                var reader = new FileReader();
                reader.readAsText(filetest, 'UTF-8');

                // here we tell the reader what to do when it's done reading...
                reader.onload = readerEvent => {
                    var content = readerEvent.target.result; // this is the content!

                    keys = content.split('\n')
                    publicKey = keys[0].split(':')
                    privateKey = keys[1].split(':')
                    pubKey = publicKey[1]
                    privKey = privateKey[1]


                    document.getElementById("GeneratedKeyBox").style.display = "block"
                    document.getElementById("pubKeyDisplayPublic").innerHTML = '<div>Public Key:</div>' + pubKey + '\n';
                    document.getElementById("pubKeyDisplayPublic").innerHTML += '<div class ="publickey">Private Key:</div>' + privKey
                    document.getElementById("buttonboxthreshold").style.display = "block"

                }



            }

            input.click();
        }

        function copyClipboard() {
            var copyText = document.getElementById("roombox");
            navigator.clipboard.writeText(copyText.value)
        }

        function randomEmoji() {

            allowedEmojis = ['ğŸ˜„', 'ğŸ˜ƒ', 'ğŸ˜€', 'ğŸ˜Š', 'ğŸ˜‰', 'ğŸ˜', 'ğŸ˜˜', 'ğŸ˜š', 'ğŸ˜—', 'ğŸ˜™', 'ğŸ˜œ', 'ğŸ˜', 'ğŸ˜›', 'ğŸ˜³', 'ğŸ˜', 'ğŸ˜”', 'ğŸ˜Œ', 'ğŸ˜’', 'ğŸ˜', 'ğŸ˜£', 'ğŸ˜¢', 'ğŸ˜‚', 'ğŸ˜­', 'ğŸ˜ª', 'ğŸ˜¥', 'ğŸ˜°', 'ğŸ˜…', 'ğŸ˜“', 'ğŸ˜©', 'ğŸ˜«', 'ğŸ˜¨', 'ğŸ˜±', 'ğŸ˜ ', 'ğŸ˜¡', 'ğŸ˜¤', 'ğŸ˜–', 'ğŸ˜†', 'ğŸ˜‹', 'ğŸ˜·', 'ğŸ˜', 'ğŸ˜´', 'ğŸ˜µ', 'ğŸ˜²', 'ğŸ˜Ÿ', 'ğŸ˜¦', 'ğŸ˜§', 'ğŸ˜ˆ', 'ğŸ‘¿', 'ğŸ˜®', 'ğŸ˜¬', 'ğŸ˜', 'ğŸ˜•', 'ğŸ˜¯', 'ğŸ˜¶', 'ğŸ˜‡', 'ğŸ˜', 'ğŸ˜‘', 'ğŸ‘²', 'ğŸ‘³', 'ğŸ‘®', 'ğŸ‘·', 'ğŸ’‚', 'ğŸ‘¶', 'ğŸ‘¦', 'ğŸ‘§', 'ğŸ‘¨', 'ğŸ‘©', 'ğŸ‘´', 'ğŸ‘µ', 'ğŸ‘±', 'ğŸ‘¼', 'ğŸ‘¸', 'ğŸ˜º', 'ğŸ˜¸', 'ğŸ˜»', 'ğŸ˜½', 'ğŸ˜¼', 'ğŸ™€', 'ğŸ˜¿', 'ğŸ˜¹', 'ğŸ˜¾', 'ğŸ‘¹', 'ğŸ‘º', 'ğŸ™ˆ', 'ğŸ™‰', 'ğŸ™Š', 'ğŸ’€', 'ğŸ‘½', 'ğŸ’©', 'ğŸ”¥', 'âœ¨', 'ğŸŒŸ', 'ğŸ’«', 'ğŸ’¥', 'ğŸ’¢', 'ğŸ’¦', 'ğŸ’§', 'ğŸ’¤', 'ğŸ’¨', 'ğŸ‘‚', 'ğŸ‘€', 'ğŸ‘ƒ', 'ğŸ‘…', 'ğŸ‘„', 'ğŸ‘', 'ğŸ‘', 'ğŸ‘Œ', 'ğŸ‘Š', 'âœŠ', 'âœŒ', 'ğŸ‘‹', 'âœ‹', 'ğŸ‘', 'ğŸ‘†', 'ğŸ‘‡', 'ğŸ‘‰', 'ğŸ‘ˆ', 'ğŸ™Œ', 'ğŸ™', 'â˜', 'ğŸ‘', 'ğŸ’ª', 'ğŸš¶', 'ğŸƒ', 'ğŸ’ƒ', 'ğŸ‘«', 'ğŸ‘ª', 'ğŸ‘¬', 'ğŸ‘­', 'ğŸ’', 'ğŸ’‘', 'ğŸ‘¯', 'ğŸ™†', 'ğŸ™…', 'ğŸ’', 'ğŸ™‹', 'ğŸ’†', 'ğŸ’‡', 'ğŸ’…', 'ğŸ‘°', 'ğŸ™', 'ğŸ™', 'ğŸ™‡', 'ğŸ©', 'ğŸ‘‘', 'ğŸ‘’', 'ğŸ‘Ÿ', 'ğŸ‘', 'ğŸ‘¡', 'ğŸ‘ ', 'ğŸ‘¢', 'ğŸ‘•', 'ğŸ‘”', 'ğŸ‘š', 'ğŸ‘—', 'ğŸ½', 'ğŸ‘–', 'ğŸ‘˜', 'ğŸ‘™', 'ğŸ’¼', 'ğŸ‘œ', 'ğŸ‘', 'ğŸ‘›', 'ğŸ‘“', 'ğŸ€', 'ğŸŒ‚', 'ğŸ’„', 'ğŸ’›', 'ğŸ’™', 'ğŸ’œ', 'ğŸ’š', 'â¤', 'ğŸ’”', 'ğŸ’—', 'ğŸ’“', 'ğŸ’•', 'ğŸ’–', 'ğŸ’', 'ğŸ’˜', 'ğŸ’Œ', 'ğŸ’‹', 'ğŸ’', 'ğŸ’', 'ğŸ‘¤', 'ğŸ‘¥', 'ğŸ’¬', 'ğŸ‘£', 'ğŸ’­', 'ğŸ¶', 'ğŸº', 'ğŸ±', 'ğŸ­', 'ğŸ¹', 'ğŸ°', 'ğŸ¸', 'ğŸ¯', 'ğŸ¨', 'ğŸ»', 'ğŸ·', 'ğŸ½', 'ğŸ®', 'ğŸ—', 'ğŸµ', 'ğŸ’', 'ğŸ´', 'ğŸ‘', 'ğŸ˜', 'ğŸ¼', 'ğŸ§', 'ğŸ¦', 'ğŸ¤', 'ğŸ¥', 'ğŸ£', 'ğŸ”', 'ğŸ', 'ğŸ¢', 'ğŸ›', 'ğŸ', 'ğŸœ', 'ğŸ', 'ğŸŒ', 'ğŸ™', 'ğŸš', 'ğŸ ', 'ğŸŸ', 'ğŸ¬', 'ğŸ³', 'ğŸ‹', 'ğŸ„', 'ğŸ', 'ğŸ€', 'ğŸƒ', 'ğŸ…', 'ğŸ‡', 'ğŸ‰', 'ğŸ', 'ğŸ', 'ğŸ“', 'ğŸ•', 'ğŸ–', 'ğŸ', 'ğŸ‚', 'ğŸ²', 'ğŸ¡', 'ğŸŠ', 'ğŸ«', 'ğŸª', 'ğŸ†', 'ğŸˆ', 'ğŸ©', 'ğŸ¾', 'ğŸ’', 'ğŸŒ¸', 'ğŸŒ·', 'ğŸ€', 'ğŸŒ¹', 'ğŸŒ»', 'ğŸŒº', 'ğŸ', 'ğŸƒ', 'ğŸ‚', 'ğŸŒ¿', 'ğŸŒ¾', 'ğŸ„', 'ğŸŒµ', 'ğŸŒ´', 'ğŸŒ²', 'ğŸŒ³', 'ğŸŒ°', 'ğŸŒ±', 'ğŸŒ¼', 'ğŸŒ', 'ğŸŒ', 'ğŸŒ', 'ğŸŒš', 'ğŸŒ‘', 'ğŸŒ’', 'ğŸŒ“', 'ğŸŒ”', 'ğŸŒ•', 'ğŸŒ–', 'ğŸŒ—', 'ğŸŒ˜', 'ğŸŒœ', 'ğŸŒ›', 'ğŸŒ™', 'ğŸŒ', 'ğŸŒ', 'ğŸŒ', 'ğŸŒ‹', 'ğŸŒŒ', 'ğŸŒ ', 'â­', 'â˜€', 'â›…', 'â˜', 'âš¡', 'â˜”', 'â„', 'â›„', 'ğŸŒ€', 'ğŸŒ', 'ğŸŒˆ', 'ğŸŒŠ', 'ğŸ', 'ğŸ’', 'ğŸ', 'ğŸ’', 'ğŸ“', 'ğŸ', 'ğŸ†', 'ğŸ‡', 'ğŸ', 'ğŸ‘', 'ğŸƒ', 'ğŸ‘»', 'ğŸ…', 'ğŸ„', 'ğŸ', 'ğŸ‹', 'ğŸ‰', 'ğŸŠ', 'ğŸˆ', 'ğŸŒ', 'ğŸ”®', 'ğŸ¥', 'ğŸ“·', 'ğŸ“¹', 'ğŸ“¼', 'ğŸ’¿', 'ğŸ“€', 'ğŸ’½', 'ğŸ’¾', 'ğŸ’»', 'ğŸ“±', 'â˜', 'ğŸ“', 'ğŸ“Ÿ', 'ğŸ“ ', 'ğŸ“¡', 'ğŸ“º', 'ğŸ“»', 'ğŸ”Š', 'ğŸ”‰', 'ğŸ”ˆ', 'ğŸ”‡', 'ğŸ””', 'ğŸ”•', 'ğŸ“¢', 'ğŸ“£', 'â³', 'âŒ›', 'â°', 'âŒš', 'ğŸ”“', 'ğŸ”’', 'ğŸ”', 'ğŸ”', 'ğŸ”‘', 'ğŸ”', 'ğŸ’¡', 'ğŸ”¦', 'ğŸ”†', 'ğŸ”…', 'ğŸ”Œ', 'ğŸ”‹', 'ğŸ”', 'ğŸ›', 'ğŸ›€', 'ğŸš¿', 'ğŸš½', 'ğŸ”§', 'ğŸ”©', 'ğŸ”¨', 'ğŸšª', 'ğŸš¬', 'ğŸ’£', 'ğŸ”«', 'ğŸ”ª', 'ğŸ’Š', 'ğŸ’‰', 'ğŸ’°', 'ğŸ’´', 'ğŸ’µ', 'ğŸ’·', 'ğŸ’¶', 'ğŸ’³', 'ğŸ’¸', 'ğŸ“²', 'ğŸ“§', 'ğŸ“¥', 'ğŸ“¤', 'âœ‰', 'ğŸ“©', 'ğŸ“¨', 'ğŸ“¯', 'ğŸ“«', 'ğŸ“ª', 'ğŸ“¬', 'ğŸ“­', 'ğŸ“®', 'ğŸ“¦', 'ğŸ“', 'ğŸ“„', 'ğŸ“ƒ', 'ğŸ“‘', 'ğŸ“Š', 'ğŸ“ˆ', 'ğŸ“‰', 'ğŸ“œ', 'ğŸ“‹', 'ğŸ“…', 'ğŸ“†', 'ğŸ“‡', 'ğŸ“', 'ğŸ“‚', 'âœ‚', 'ğŸ“Œ', 'ğŸ“', 'âœ’', 'âœ', 'ğŸ“', 'ğŸ“', 'ğŸ“•', 'ğŸ“—', 'ğŸ“˜', 'ğŸ“™', 'ğŸ““', 'ğŸ“”', 'ğŸ“’', 'ğŸ“š', 'ğŸ“–', 'ğŸ”–', 'ğŸ“›', 'ğŸ”¬', 'ğŸ”­', 'ğŸ“°', 'ğŸ¨', 'ğŸ¬', 'ğŸ¤', 'ğŸ§', 'ğŸ¼', 'ğŸµ', 'ğŸ¶', 'ğŸ¹', 'ğŸ»', 'ğŸº', 'ğŸ·', 'ğŸ¸', 'ğŸ‘¾', 'ğŸ®', 'ğŸƒ', 'ğŸ´', 'ğŸ€„', 'ğŸ²', 'ğŸ¯', 'ğŸˆ', 'ğŸ€', 'âš½', 'âš¾', 'ğŸ¾', 'ğŸ±', 'ğŸ‰', 'ğŸ³', 'â›³', 'ğŸšµ', 'ğŸš´', 'ğŸ', 'ğŸ‡', 'ğŸ†', 'ğŸ¿', 'ğŸ‚', 'ğŸŠ', 'ğŸ„', 'ğŸ£', 'â˜•', 'ğŸµ', 'ğŸ¶', 'ğŸ¼', 'ğŸº', 'ğŸ»', 'ğŸ¸', 'ğŸ¹', 'ğŸ·', 'ğŸ´', 'ğŸ•', 'ğŸ”', 'ğŸŸ', 'ğŸ—', 'ğŸ–', 'ğŸ', 'ğŸ›', 'ğŸ¤', 'ğŸ±', 'ğŸ£', 'ğŸ¥', 'ğŸ™', 'ğŸ˜', 'ğŸš', 'ğŸœ', 'ğŸ²', 'ğŸ¢', 'ğŸ¡', 'ğŸ³', 'ğŸ', 'ğŸ©', 'ğŸ®', 'ğŸ¦', 'ğŸ¨', 'ğŸ§', 'ğŸ‚', 'ğŸ°', 'ğŸª', 'ğŸ«', 'ğŸ¬', 'ğŸ­', 'ğŸ¯', 'ğŸ', 'ğŸ', 'ğŸŠ', 'ğŸ‹', 'ğŸ’', 'ğŸ‡', 'ğŸ‰', 'ğŸ“', 'ğŸ‘', 'ğŸˆ', 'ğŸŒ', 'ğŸ', 'ğŸ', 'ğŸ ', 'ğŸ†', 'ğŸ…', 'ğŸŒ½', 'ğŸ ', 'ğŸ¡', 'ğŸ«', 'ğŸ¢', 'ğŸ£', 'ğŸ¥', 'ğŸ¦', 'ğŸª', 'ğŸ©', 'ğŸ¨', 'ğŸ’’', 'â›ª', 'ğŸ¬', 'ğŸ¤', 'ğŸŒ‡', 'ğŸŒ†', 'ğŸ¯', 'ğŸ°', 'â›º', 'ğŸ­', 'ğŸ—¼', 'ğŸ—¾', 'ğŸ—»', 'ğŸŒ„', 'ğŸŒ…', 'ğŸŒƒ', 'ğŸ—½', 'ğŸŒ‰', 'ğŸ ', 'ğŸ¡', 'â›²', 'ğŸ¢', 'ğŸš¢', 'â›µ', 'ğŸš¤', 'ğŸš£', 'âš“', 'ğŸš€', 'âœˆ', 'ğŸ’º', 'ğŸš', 'ğŸš‚', 'ğŸšŠ', 'ğŸš‰', 'ğŸš', 'ğŸš†', 'ğŸš„', 'ğŸš…', 'ğŸšˆ', 'ğŸš‡', 'ğŸš', 'ğŸš‹', 'ğŸšƒ', 'ğŸš', 'ğŸšŒ', 'ğŸš', 'ğŸš™', 'ğŸš˜', 'ğŸš—', 'ğŸš•', 'ğŸš–', 'ğŸš›', 'ğŸšš', 'ğŸš¨', 'ğŸš“', 'ğŸš”', 'ğŸš’', 'ğŸš‘', 'ğŸš', 'ğŸš²', 'ğŸš¡', 'ğŸšŸ', 'ğŸš ', 'ğŸšœ', 'ğŸ’ˆ', 'ğŸš', 'ğŸ«', 'ğŸš¦', 'ğŸš¥', 'âš ', 'ğŸš§', 'ğŸ”°', 'â›½', 'ğŸ®']
            emojis = [Math.floor(Math.random() * allowedEmojis.length)];
            emoji = allowedEmojis[emojis[0]]
            return emoji
        }

        var input = document.getElementById("nameEntry");
        input.addEventListener("keyup", function (event) {
            if (event.keyCode === 13) {
                event.preventDefault();
                document.getElementById("enterName").click();
            }
        });
    </script>
</body>

</html>

<style>
    /* Add a black background color to the top navigation bar */
    .emojititle {
        font-size: 10vw;
    }

    .title {
        font-size: 5vw;
        font-family: Arial, Helvetica, sans-serif;
        font-weight: bold;
    }

    #button1,
    #button2 {
        display: inline-block;
    }

    #buttonSavegroup {
        display: inline-block;
        margin-left: 40px;
    }

    #pubKeyDisplay,
    #GeneratedKeyBox,
    #buttonboxthreshold,
    #nameContainer,
    #groupinfobox,
    #ProposedMessageDisplay,
    #signOrNot,
    #myProgress,
    #Legend,
    #roomIsFull, #aggSigAggKeyDisplay, #SaveSignatureInfo {
        display: none;
    }

    #readybutton {
        display: none;
        text-align: center;
    }

    #myProgress {
        position: relative;
        width: 100%;
        background-color: #fadb8d;

    }

    #currentSigned {
        position: absolute;
        width: 0%;
        height: 50px;
        background-color: #ce6df8;
    }

    #thresholdBar {

        width: 0%;
        height: 50px;
        background-color: #e0acf7;
    }


    .buttonbox {
        text-align: center;
        padding-bottom: 20px;
    }

    .titlebox {
        text-align: center;
        padding-bottom: 10px;
    }

    .namebox {

        border: 0;
        outline: 0;
        font-size: 25px;
        text-align: center;
        background: transparent;
        border-bottom: 2px solid rgb(253, 232, 191);
        width: 30%;
    }

    .roombox {

        border: 0;
        outline: 0;
        font-size: 40px;
        text-align: center;
        background: transparent;
        color: grey;
        border-bottom: 2px solid rgb(253, 232, 191);
        min-width: 30%;
        width: auto;
    }

    .keys {
        text-align: center;
        font-family: Arial, Helvetica, sans-serif;
        font-size: 30px;
        margin-bottom: 10px;
    }

    .keysdisplay {
        text-align: center;
        font-family: Arial, Helvetica, sans-serif;
        font-size: 25px;
        overflow: hidden;
        word-wrap: break-word;
        border-radius: 25px;
        border: 2px solid #8d7745;
        padding: 20px;

    }

    .keycontainer {
        padding-bottom: 30px;
    }

    body {
        background-color: #fef2dc;
        margin-left: 15%;
        margin-right: 15%;

    }

    #ThresholdDisplay {
        display: inline;
    }

    .copyButton {
        border: none;
        outline: none;
        background-color: #fef2dc;
        font-size: 35px;
    }

    .copyButton:active {
        transform: translateY(4px);
    }

    .namecontainer {
        text-align: center;
        padding-bottom: 20px;
    }

    .roomcontainer {
        display: none;
        text-align: center;
        padding-bottom: 20px;
    }

    body {
        background-color: rgb(254, 242, 220);
    }

    .emojibutton {
        font-size: 25px;
        font-family: 'Poppins', sans-serif;
        font-weight: 600;
        color: #fff;
        border: 0;
        outline: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        height: 2.5em;
        padding: 0.5em 0.75em;
        border-radius: 0.25em;
        box-sizing: border-box;
        background-color: #e0acf7;
        box-shadow: 0 0.15em 1em rgba(0, 0, 0, 0.2);
        z-index: 1;
        transition-duration: 0.4s;
        cursor: pointer;
    }

    .colour {
        width: 50px;
        height: 50px;
        margin: 5px;
    }

    .darkpurp {
        background: #ce6df8;
    }

    .lightpurp {
        background: #e0acf7;
    }

    .yellow {
        background: #fadb8d;
    }

    .Legend {
        font-family: Arial, Helvetica, sans-serif;
        font-size: 20px;
        padding-bottom: 20px;
        height: 50px;
        padding-top: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    #buttonboxpadding{
        padding-top: 20px;
    }

    .emojibutton:hover {
        background-color: #cc70f3;
        color: white;
    }

    .joinedNames {
        font-size: 25px;
        font-family: 'Poppins', sans-serif;
        font-weight: 600;
        color: #fff;
        border: 0;
        outline: 0;
        float: left;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        height: 2.5em;
        padding: 0.5em 0.75em;
        border-radius: 0.25em;
        box-sizing: border-box;
        background-color: #16C60C;
        box-shadow: 0 0.15em 1em rgba(0, 0, 0, 0.2);
        z-index: 1;
        transition-duration: 0.4s;
        cursor: pointer;
    }

    .joinedNames:hover {
        background-color: #12970b;
        color: white;
    }

    .emojilink {
        text-decoration: none;
    }
</style>